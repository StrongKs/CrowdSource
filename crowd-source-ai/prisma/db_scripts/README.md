# Data Base Information

## General Information
schema.prisma file is the layout/tables of our data base. We are using neon site to hold our data base `https://console.neon.tech/app/projects`. You edit file to edite our data tables then push the update to server with command `npx prisma db push`. We can test queries with scripts

## Connecting to Data Base
Must have `.env` file in root of `crowd-source-ai` folder. Ensure to enclude the file name in your `.gitignore` file which is in same root location. Define `DATABASE_URL= ... ` variable in your `.env` this is your end point to connect to db. We can make branches of out db like github.

## Scripts Information
`crowd-source-ai/prisma/db_Scripts` contains scripts to test and query bd. There are folders describing types of incident data with posts and comments generated by chatGPT. There is .txt for easy reading but also .json for parsing.

To run update `package.json` in root directory and add Script Name like `dbSandBox` with the command `npm tsx (filepath)`. Then to execute script file run `npm run (Script Name)` in terminal. In this example it would be `npm run dbSandBox`.

Must have `tsx` package installed to run the .tsx script. Run `npm install -g tsx` in terminal.

```
 "scripts": {
    "dbSandBox": "npx tsx prisma/db_Scripts/sandbox.tsx",
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
```

### Script files
1. `sandbox`: Testing environment to help make scripts and query db
2. `syntheticDataGainesville`: Generates 150 posts and ~250 comments about UF Marston fire
3. `syntheticDataPalisades`: Generates 500 posts and ~ 750 comments about Palisades fires.
4. `syntheticDataSanFancisco`: Generates 500 posts and ~ 750 comments about SanFancisco earthquak
5. `deleteData`: deletes all data in the tables. Leaves tables as is

# Commands:

## View Tables
`npx prisma studio` - Locally will display tables in a localhost:port on your machine (better than looking through neon site)

## Dependancies
`npm install -g tsx` - package to run .tsx files
`npm install --save-dev @faker-js/faker` - prisma's buit-in seeding to add synthetic data

## Development
1. `npx prisma validate` - checks syntax (do before you generate generator Client)
2. `npx prisma generate` - Generate Prisma Client (Required After Schema Changes). Allows to use prisma objects/tables (ex. cliam, client) in our project.
3. `npx prisma db push` - db push (Development Mode). Update current db
4. `npx prisma migrate dev --name your_migration_name` - migrate dev. Creates branch like github.

# Clean cache
```
rm -rf node_modules/.prisma
npx prisma generate
```